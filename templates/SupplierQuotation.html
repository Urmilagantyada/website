<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>OmniPro Pvt Ltd</title>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />

        <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
        <link href="https://cdn.datatables.net/1.10.20/css/dataTables.bootstrap4.min.css" rel="stylesheet"
            crossorigin="anonymous" />
        <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/js/all.min.js" crossorigin="anonymous">
        </script>
        <link href="https://fonts.googleapis.com/css2?family=Lora:wght@700&display=swap" rel="stylesheet">
    
        
        <style>

        </style>
    </head>
    <body class="sb-nav-fixed">
        {%include "header.html"%}

                <main>
                  
                                <form action="{{url_for('SupplierQuotation')}}" method="POST" enctype="multipart/form-data">
                                
                                
                                    <div id="dialog" class="modal">
                                        <div class="modal-content">
                                            <span class="close">&times;</span>
                                            <h2>Add Suppliers_Quote</h2>
                                            <form id="studentForm" method="POST" enctype="multipart/form-data">
                                                <div class="form-row">
                                                    
                                                    <div class="form-group col-md-6">
                                                        <label for="manfacturename"><b>MFR/Supplier Name:</b>
                                                            </label>
                                                        
                                                        <select class="form-control" id="manfacturename" name="manfacturename">
                                                            <option value="" disabled selected>Select Supplier</option>
                                                            {% for supplier in suppliers %}
                                                            <option value="{{ supplier[0] }}">{{ supplier[0] }}</option>
                                                            {% endfor %}
                                                        </select>
                                                    </div>
                                                    <div class="form-group col-md-6">
                                                        <label for="supplierrfqdate"><b>Supplier RFQ Date:</b></label>
                                                        <input type="date" class="form-control" id="supplierrfqdate" name="supplierrfqdate" max="{{max_date}}">
                                                    </div>
                                                    <div class="form-group col-md-3">
                                                        <label for="supplierquotedate"><b>Supplier Quote Date:</b></label>
                                                        <input type="date" class="form-control" id="supplierquotedate" name="supplierquotedate">
                                                    </div>
                                                    
                                                    <div class="form-group col-md-3">
                                                        <label for="Suppliercontact"><b>Supplier Contact:</b></label>
                                                        <select class="form-control" id="Suppliercontact" name="Suppliercontact">
                                                            <option value="">--Select Supplier Contact--</option>
                                                        </select>
                                                    </div>
                                                    <div class="form-group col-md-6">
                                                        <label for="remarks"><b>Remarks:</b></label>
                                                        <textarea class="form-control" id="remarks" name="remarks" placeholder="Enter remarks" rows="2"></textarea>
                                                    </div>
                                                </div>
                                                
                                                <div class="containerr">
                                                    <h5>Add Supplier Quote for RFQ Items</h5>
                                                    <table id="productTable">
                                                        <thead>
                                                            <tr>
                                                                <th>Quoted Part No</th>
                                                                <th>Quoted Make</th>
                                                                <th>Quantity Requested</th>
                                                                <th>Supplier Stock</th>
                                                                <th>Unit Price</th>
                                                                <th>Items Value</th>
                                                                <th>Quote Details</th>
                                                                <th>Remarks</th>
                                                                <th>Action</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <!-- Initial row will be inserted here by JavaScript -->
                                                        </tbody>
                                                    </table>
                                                    <button id="addRowBtn" type="button">+</button>
                                                </div>
                                                

                                                <div class="form-group col-md-4">
                                                    <label for="file"><b>Upload Excel:</b></label>
                                                    <input type="file" class="form-control" id="file" name="file" accept=".xlsx, .xls">
                                                </div>
                                                <a id="download_link" href="/uploads/suppliers_offers.xlsx">Download Sample File</a><br><br>
                
                                                <button type="submit" class="btn btn-primary" style="width: 100px;">Submit</button>
                                            </form>
                                        </div>
                                    </div>
                                    
                                    <div class="card mb-4">
                                        <div class="card-header" style="padding: 5px 10px; height: 50px;">
                                            <div class="d-flex justify-content-between align-items-center h-100">
                                                <!-- Left-side buttons (Add, Contacts, Export) -->
                                                <div class="d-flex align-items-center" style="gap: 10px;">
                                                    <button id="addNewBtn" type="button" class="btn btn-primary" 
                                                            style="padding: 5px 10px; font-size: 0.85rem; border-radius: 5px;">
                                                        <i class="fas fa-plus"></i> Add
                                                    </button>
                                                    <a href="{{ url_for('manage_supquo') }}">
                                                        <button type="button" class="btn btn-danger" 
                                                                style="padding: 5px 10px; font-size: 0.85rem; border-radius: 5px;">
                                                            Supplier Quotation
                                                        </button>
                                                    </a>
                                                    <a href="{{ url_for('export_suppliers_offers_data') }}">
                                                        <button type="button" class="btn btn-success" 
                                                                style="padding: 5px 10px; font-size: 0.85rem; border-radius: 5px;">
                                                            Export
                                                        </button>
                                                    </a>
                                                </div>
                                                <h2 style="color: #20B2AA;"> SUPPLIERS QUOTATION</h2>
                                                <!-- Right-side Search form -->
                                                <div class="d-flex align-items-center">
                                                    <form method="GET" action="{{ url_for('SupplierQuotation') }}" class="d-flex align-items-center" enctype="multipart/form-data" style="gap: 5px;">
                                                        <label for="search" class="mb-0" style="margin-right: 5px; font-size: 0.85rem;">Search:</label>
                                                        <input type="text" id="search" name="search" value="{{ search_query }}" 
                                                               class="form-control form-control-sm" style="padding: 5px; font-size: 0.85rem; border-radius: 5px;">
                                                        <button type="submit" class="btn btn-primary" style="padding: 5px 10px; font-size: 0.85rem; border-radius: 5px;">
                                                            Search
                                                        </button>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                
                                    
                                            <div class="table-responsive">
                                                <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
                                                    <thead>
                                                        <tr>
                                                            <th scope="col">#</th>
                                                           
                                                            <th scope="col">MFR/Supplier Name</th>
                                                            <th scope="col">Supplier RFQ Date</th>
                                                            <th scope="col">Supplier Due Date</th>
                                                            <th scope="col">Supplier Contact</th>
                                                            
                                                            <th scope="col">Remarks</th>
                                                         
                                                            <th scope="col">Action</th>
                                                        </tr>
                                                    </thead>
                                                    
                                                    <tbody>
                                                        {% for record in SupplierQuotation %}
                                                        <tr>
                                                            <td>{{ (page - 1) * per_page + loop.index }}</td>
                                                            <td>{{ record[1] }}</td>
                                                            <td>{{ record[2] }}</td>
                                                            <td>{{ record[3] }}</td>
                                                            <td>{{ record[4] }}</td>
                                                            <td>{{ record[5] }}</td>

                                                           
                                                            <!-- <td>{{ record[7] }}</td> -->
                                                            
                                                            <td>
                                                               
                                                 <a href="/update_supplierquotation/{{record.0}}" class="btn btn-warning btn-sm"
                                                 data-toggle="modal" data-target="#modaleditup{{record.0}}"
                                                 style="position: relative; display: inline-block; cursor: pointer;"
                                                 onmouseover="this.querySelector('.tooltiptext').style.visibility = 'visible'; this.querySelector('.tooltiptext').style.opacity = '1';"
                                                 onmouseout="this.querySelector('.tooltiptext').style.visibility = 'hidden'; this.querySelector('.tooltiptext').style.opacity = '0';">
                                                 <i class="fas fa-edit"></i>
                                                 <span class="tooltiptext" style="
                                                     visibility: hidden;
                                                     width: 100px;
                                                     background-color: black;
                                                     color: #fff;
                                                     text-align: center;
                                                     border-radius: 5px;
                                                     padding: 5px;
                                                     position: absolute;
                                                     z-index: 1;
                                                     bottom: 125%;
                                                     left: 50%;
                                                     margin-left: -50px;
                                                     opacity: 0;
                                                     transition: opacity 0.3s;
                                                 ">Edit</span>
                                              </a>
                                              
                                              <!-- Delete Button -->
                                              <a href="/delete_supplierquotation/{{ record.0 }}" onclick="return confirm('Are you sure you want to delete?');" class="btn btn-danger btn-sm"
                                                 style="position: relative; display: inline-block; cursor: pointer;"
                                                 onmouseover="this.querySelector('.tooltiptext').style.visibility = 'visible'; this.querySelector('.tooltiptext').style.opacity = '1';"
                                                 onmouseout="this.querySelector('.tooltiptext').style.visibility = 'hidden'; this.querySelector('.tooltiptext').style.opacity = '0';">
                                                 <i class="fas fa-trash-alt"></i>
                                                 <span class="tooltiptext" style="
                                                     visibility: hidden;
                                                     width: 100px;
                                                     background-color: black;
                                                     color: #fff;
                                                     text-align: center;
                                                     border-radius: 5px;
                                                     padding: 5px;
                                                     position: absolute;
                                                     z-index: 1;
                                                     bottom: 125%;
                                                     left: 50%;
                                                     margin-left: -50px;
                                                     opacity: 0;
                                                     transition: opacity 0.3s;
                                                 ">Delete</span>
                                              </a>
     
                                              <a href="/add_supplier_quotation/{{ record[0] }}" class="btn btn-primary btn-sm"
                                                                     data-toggle="modal" data-target="#modaleditadd{{ record[0] }}"
                                                                     style="position: relative; display: inline-block; cursor: pointer;"
                                                                     onmouseover="this.querySelector('.tooltiptext').style.visibility = 'visible'; this.querySelector('.tooltiptext').style.opacity = '1';"
                                                                     onmouseout="this.querySelector('.tooltiptext').style.visibility = 'hidden'; this.querySelector('.tooltiptext').style.opacity = '0';">
                                                                     +
                                                                     <span class="tooltiptext" style="
                                                                         visibility: hidden;
                                                                         width: 120px;
                                                                         background-color: black;
                                                                         color: #fff;
                                                                         text-align: center;
                                                                         border-radius: 5px;
                                                                         padding: 5px;
                                                                         position: absolute;
                                                                         z-index: 1;
                                                                         bottom: 125%;
                                                                         left: 50%;
                                                                         margin-left: -60px;
                                                                         opacity: 0;
                                                                         transition: opacity 0.3s;
                                                                     ">Add RFQ Item</span>
                                                                  </a>
                                                                  <a href="/add_supplierquote_excel/{{ record[0] }}" class="btn btn-success btn-sm"
                                                                  data-toggle="modal" data-target="#modaleditexcel{{ record[0] }}"
                                                                  style="position: relative; display: inline-block; cursor: pointer;"
                                                                  onmouseover="this.querySelector('.tooltiptext').style.visibility = 'visible'; this.querySelector('.tooltiptext').style.opacity = '1';"
                                                                  onmouseout="this.querySelector('.tooltiptext').style.visibility = 'hidden'; this.querySelector('.tooltiptext').style.opacity = '0';">
                                                                  <span class="material-symbols-outlined">
                                                                      cloud_upload
                                                                      </span>
                                                                  <span class="tooltiptext" style="
                                                                      visibility: hidden;
                                                                      width: 120px;
                                                                      background-color: black;
                                                                      color: #fff;
                                                                      text-align: center;
                                                                      border-radius: 5px;
                                                                      padding: 5px;
                                                                      position: absolute;
                                                                      z-index: 1;
                                                                      bottom: 125%;
                                                                      left: 50%;
                                                                      margin-left: -60px;
                                                                      opacity: 0;
                                                                      transition: opacity 0.3s;
                                                                  ">Import</span>
                                                               </a>
                                                            </td>
                                                       </tr>
                                                       <div class="modal fade" id="modaleditadd{{ record[0] }}" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                                        <div class="modal-dialog" role="document">
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h5 class="modal-title" id="exampleModalLabel"> Add Supplier Quotation Items </h5>
                                                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                        <span aria-hidden="true">&times;</span>
                                                                    </button>
                                                                </div>
                                                                <div class="modal-body">
                                                    
                                                                    <form method="post" action="{{ url_for('add_supplierquo') }}" enctype="multipart/form-data">



                                                                        <div class="form-group">
                                                                            <label for="modal-name"> Supplier Name</label>
                                                                            <select class="form-control" id="supplier_name" name="supplier_name">
                                                                                {% for branch in suppliers %}
                                                                                    <option value="{{ branch[0] }}" {% if branch[0] == record[1] %} selected {% endif %}>{{ branch[0] }}</option>
                                                                                {% endfor %}
                                                                            </select>
                                                                        </div>
                                                                        
                                                                    
                                                                        <div class="form-group">
                                                                            <label for="part_no"> Part No</label>
                                                                            <input type="text" class="form-control" id="part_no" name="part_no" required>
                                                                        </div>

                                                                        <div class="form-group">
                                                                            <label for="make"> Make </label>
                                                                            <input type="text" class="form-control" id="make" name="make" required>
                                                                        </div>
                                                                        <div class="form-group">
                                                                            <label for="quantity_requested"> Quantity Requested </label>
                                                                            <input type="text" class="form-control" id="quantity_requested" name="quantity_requested" required>
                                                                        </div>

                                                                        <div class="form-group"></div>
                                                                            <label for="stock"> Stock </label>
                                                                            <input type="text" class="form-control" id="stock" name="stock" required>
                                                                        </div>
                                                                        <div class="form-group">
                                                                            <label for="price"> Price  </label>
                                                                            <input type="text" class="form-control" id="price" name="price" required>
                                                                        </div>

                                                                        <div class="form-group">
                                                                            <label for="item"> Item  </label>
                                                                            <input type="text" class="form-control" id="item" name="item" required>
                                                                        </div>

                                                                        <div class="form-group">
                                                                            <label for="details"> Details </label>
                                                                            <input type="text" class="form-control" id="details" name="details" required>
                                                                        </div>
                                                                        <div class="form-group">
                                                                            <label for="remarks"> Remarks  </label>
                                                                            <input type="text" class="form-control" id="remarks" name="remarks" required>
                                                                        </div>

                                                                        <button type="submit" class="btn btn-primary">Submit</button>
                                                                    </form>
                                                                    
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>



                                                    <div class="modal fade" id="modaleditexcel{{ record[0] }}" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                                        <div class="modal-dialog" role="document">
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h5 class="modal-title" id="exampleModalLabel"> Add Supplier Qoute Items </h5>
                                                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                        <span aria-hidden="true">&times;</span>
                                                                    </button>
                                                                </div>
                                                                <div class="modal-body">
                                                    
                                                                    <form method="post" action="{{ url_for('add_supplier_quote_excel') }}" enctype="multipart/form-data" >
                                                                        <div class="form-group">
                                                                            <label for="modal-name"> Manufacturer name </label>
                                                                            <select class="form-control" id="manufacture_name" name="manufacture_name">
                                                                                {% for branch in suppliers %}
                                                                                    <option value="{{ branch[0] }}" {% if branch[0] == record[1] %} selected {% endif %}>{{ branch[0] }}</option>
                                                                                {% endfor %}
                                                                            </select>
                                                                        </div>
                                                                        
                                                                        <div class="form-group ">
                                                                            <label for="file">Upload Excel:</label>
                                                                            <input type="file" class="form-control" id="file" name="file" accept=".xlsx, .xls">
                                                                        </div>
                                                                        <a id="download_links" href="{{ url_for('download_sample_excel_opportunity_rfq') }}" download>Download Sample File</a><br>
                                                    
                                                                        <button type="submit" class="btn btn-primary">Submit</button>
                                                                    </form>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                       <div id="modaleditup{{ record[0] }}" class="modal fade" role="dialog">
                                                        <div class="modal-dialog">
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h4 class="modal-title">Update SupplierQuotation</h4>
                                                                    <span class="b" style="width: 30px; cursor: pointer; font-size: 24px; padding: 5px; display: inline-block; text-align: center;font-weight:bold;" data-dismiss="modal">x</span>
        
                                                                </div>
                                                                <div class="modal-body">
                                                                    <form action="{{ url_for('update_supplierquotation') }}" method="POST">
                                                                        <input type="hidden" name="id" value="{{ record[0] }}">
                                                                        <div class="form-group">
                                                                            <label>Manufacturer Name</label>
                                                                            <!-- <input type="text" class="form-control" name="manfacturename" value="{{ record[1] }}" > -->
                                                                            <select class="form-control" id="manfacturename" name="manfacturename">
                                                                                {% for branch in suppliers %}
                                                                                    <option value="{{ branch[0] }}" {% if branch[0] == record[1] %} selected {% endif %}>{{ branch[0] }}</option>
                                                                                {% endfor %}
                                                                            </select>
                                                                        </div>
                                                                        <div class="form-group">
                                                                            <label>Supplier Rfq Date</label>
                                                                            <input type="date" class="form-control" name="supplierrfqdate" value="{{ record[2] }}" >
                                                                        </div>
                                                                        <div class="form-group">
                                                                            <label>Supplier Quote Date</label>
                                                                            <input type="date" class="form-control" name="supplierquotedate" value="{{ record[3] }}" >
                                                                        </div>
                                                                        <div class="form-group">
                                                                            <label>Supplier Suppliercontact</label>
                                                                            <!-- <input type="text" class="form-control" name="Suppliercontact" value="{{ record[4] }}" > -->
                                                                            <select class="form-control" id="Suppliercontact" name="Suppliercontact">
                                                                                {% for branch in contact %}
                                                                                    <option value="{{ branch[0] }}" {% if branch[0] == record[4] %} selected {% endif %}>{{ branch[0] }}</option>
                                                                                {% endfor %}
                                                                            </select>
                                                                        </div>
                                                                        <div class="form-group">
                                                                            <label>Remarks</label>
                                                                            <input type="text" class="form-control" name="remarks" value="{{ record[6] }}" >
                                                                        </div>
                                                                        
                                                                        
                                                                        
                                                                    <button type="submit" class="btn btn-primary">Update</button>
                                                                    </form>
                                                                </div>
                                                                <div class="modal-footer">
                                                                    <button class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                                </div>
                                                            </div>
                                                        
                 



                                                        {% endfor %}
                                                        <!-- <tr>
                                                            <td>2</td>
                                                            
                                                            <td>123-456-7890</td>
                                                            <td>123-456-7890</td>
                                                            <td>123-456-7890</td>
                                                            
                                                           
                                                        </tr> -->
                                                        
                                                       
                                                       
                                                        
                                                    </tbody>
                                                </table>
                                            </div>
                                            <ul class="pagination" style="display: flex;justify-content: flex-end;padding: 20px;">
                                                {% if page > 1 %}
                                                <li><a href="{{ url_for('SupplierQuotation', page=1, search=search_query) }}">First</a></li>
                                                <li><a href="{{ url_for('SupplierQuotation', page=page-1, search=search_query) }}">Previous</a></li>
                                                {% endif %}
                                                {% for p in range(1, total_pages + 1) %}
                                                <li><a href="{{ url_for('SupplierQuotation', page=p, search=search_query) }}">{{ p }}</a></li>
                                                {% endfor %}
                                                {% if page < total_pages %}
                                                <li><a href="{{ url_for('SupplierQuotation', page=page+1, search=search_query) }}">Next</a></li>
                                                <li><a href="{{ url_for('SupplierQuotation', page=total_pages, search=search_query) }}">Last</a></li>
                                                {% endif %}
                                            </ul>
                                       
                                    
                                  </form>
                

                        </main>
                        <script>
                            
                           document.addEventListener('DOMContentLoaded', () => {
                               const addNewBtn = document.getElementById('addNewBtn');
                               const modal = document.getElementById('dialog');
                               const span = document.getElementsByClassName('close')[0];
                               const form = document.getElementById('studentForm');
                               const tableBody = document.querySelector('#studentTable tbody');
                               const entriesSelect = document.getElementById('entriesSelect');
                               const searchInput = document.getElementById('searchInput');
                               const pagination = document.getElementById('pagination');
                           
                               let students = [];
                               let currentPage = 1;
                               let entriesPerPage = 10;
                           
                               function renderTable() {
                                   tableBody.innerHTML = '';
                                   const filteredStudents = students.filter(student => 
                                       student.name.toLowerCase().includes(searchInput.value.toLowerCase()) ||
                                       student.gender.toLowerCase().includes(searchInput.value.toLowerCase()) ||
                                       student.phoneNumber.toLowerCase().includes(searchInput.value.toLowerCase())
                                   );
                                   const totalEntries = filteredStudents.length;
                                   const totalPages = Math.ceil(totalEntries / entriesPerPage);
                                   const start = (currentPage - 1) * entriesPerPage;
                                   const end = start + entriesPerPage;
                                   const pageStudents = filteredStudents.slice(start, end);
                           
                                   pageStudents.forEach(student => {
                                      
                                       newRow.querySelector('.deleteBtn').addEventListener('click', function() {
                                           students = students.filter(s => s !== student);
                                           renderTable();
                                       });
                                   });
                           
                                   renderPagination(totalPages);
                               }
                           
                        
                           
                               addNewBtn.onclick = function() {
                                   modal.style.display = 'block';
                               }
                           
                               span.onclick = function() {
                                   modal.style.display = 'none';
                               }
                           
                               window.onclick = function(event) {
                                   if (event.target == modal) {
                                       modal.style.display = 'none';
                                   }
                               }
                           
                               renderTable();
                           });
                       </script>
                       <footer class="py-4 bg-light mt-auto" style="position:fixed; bottom:0; width:100%;">
                        <div class="container-fluid">
                            <div class="d-flex align-items-center justify-content-between small">
                                <div class="text-muted">Copyright &copy; OmniPro Pvt Ltd</div>
                                <div>
                                    <a href="#">AeriesSoft Tech Solution</a>
                                </div>
                            </div>
                        </div>
                    </footer>
                    
            </div>
        </div>
        <script src="https://code.jquery.com/jquery-3.5.1.min.js" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
        <script src="js/scripts.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js" crossorigin="anonymous"></script>
        <script src="assets/demo/chart-area-demo.js"></script>
        <script src="assets/demo/chart-bar-demo.js"></script>
        <script src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js" crossorigin="anonymous"></script>
        <script src="https://cdn.datatables.net/1.10.20/js/dataTables.bootstrap4.min.js" crossorigin="anonymous"></script>
        <script src="assets/demo/datatables-demo.js"></script>
        <script>
            $(document).ready(function() {
                // Set the active link on page load based on the current URL
                var currentPath = window.location.pathname;
                $('.sb-sidenav .nav-link').each(function() {
                    var linkPath = $(this).attr('href');
                    if (currentPath.indexOf(linkPath) !== -1) {
                        $(this).addClass('active');
                    }
                });
        
                // Update the active link on click
                $('.sb-sidenav .nav-link').on('click', function() {
                    $('.sb-sidenav .nav-link').removeClass('active');
                    $(this).addClass('active');
                });
            });
        </script>
    </body>

</html>
<script>
    document.getElementById('addRowBtn').addEventListener('click', function(event) {
        event.preventDefault(); // Prevent the button from performing any default action
    
        // Create a new row
        var table = document.getElementById('productTable').getElementsByTagName('tbody')[0];
        var newRow = table.insertRow();
    
        // Insert cells and input fields into the new row
        var cell1 = newRow.insertCell(0);
        var cell2 = newRow.insertCell(1);
        var cell3 = newRow.insertCell(2);
        var cell4 = newRow.insertCell(3);
        var cell5 = newRow.insertCell(4);
        var cell6 = newRow.insertCell(5);
        var cell7 = newRow.insertCell(6);
        var cell8 = newRow.insertCell(7);
        var cell9 = newRow.insertCell(8);
    
        cell1.innerHTML = '<input type="text" name="quotedpart[]" class="to-uppercase" >';
        cell2.innerHTML = '<input type="text" name="quotedmake[]" class="to-uppercase">';
        cell3.innerHTML = '<input type="text" name="quotedrequest[]" class="to-uppercase" style="width:120px;">';
        cell4.innerHTML = '<input type="text" name="stock[]" class="to-uppercase" style="width:120px;">';
        cell5.innerHTML = '<input type="text" name="price[]" class="to-uppercase " style="width:120px;">';
        cell6.innerHTML = '<input type="text" name="item[]" class="to-uppercase" readonly>'; // Make item value readonly
        cell7.innerHTML = '<input type="text" name="quotedetails[]" class="to-uppercase">';
        cell8.innerHTML = '<textarea name="remarks[]" class="to-uppercase" rows="2" cols="20"></textarea>';
        cell9.innerHTML = '<button type="button" class="deleteRowBtn">x</button>';
    
        // Convert relevant inputs to uppercase
        var inputs = newRow.querySelectorAll('.to-uppercase');
        inputs.forEach(function(input) {
            input.addEventListener('input', function() {
                this.value = this.value.toUpperCase();
            });
        });
    
        // Automatically calculate item value (quantity_requested * unit_price)
        var quantityInput = cell3.querySelector('input'); // Quantity requested input
        var priceInput = cell5.querySelector('input');    // Price input
        var itemInput = cell6.querySelector('input');     // Item value input
    
        // Add event listeners to quantity and price inputs for calculation
        function calculateItemValue() {
            var quantity = parseFloat(quantityInput.value) || 0; // Parse quantity as a float
            var price = parseFloat(priceInput.value) || 0;       // Parse price as a float
            var itemValue = quantity * price;                    // Calculate item value
    
            itemInput.value = itemValue.toFixed(2);              // Set item value with 2 decimal places
        }
    
        // Attach input event listeners to recalculate item value on change
        quantityInput.addEventListener('input', calculateItemValue);
        priceInput.addEventListener('input', calculateItemValue);
    });
    
    // Use event delegation to handle delete button clicks
    document.getElementById('productTable').addEventListener('click', function(event) {
        if (event.target && event.target.classList.contains('deleteRowBtn')) {
            if (confirm('Are you sure you want to remove this row?')) {
                event.target.closest('tr').remove();
            }
        }
    });
    
</script>
<script>
    // Bind an event handler to the change event of the supplier dropdown
    $('#manfacturename').on('change', function () {
        // Capture the value of the selected supplier
        var selectedSupplier = $(this).val();

        // Make an AJAX request to fetch contact persons for the selected supplier
        $.ajax({
            type: 'POST',               // Type of request, POST is used here to send data securely
            url: '/get_contact',        // The URL to send the request to, which is a Flask route
            data: { supplier_name: selectedSupplier },  // Data sent to the server, key-value pair
            success: function (response) {  // Function executed on successful response
                // Clear existing options in the contact dropdown
                $('#Suppliercontact').empty();

                // Add the default option to the contact dropdown
                $('#Suppliercontact').append('<option value="">--Select Supplier Contact--</option>');

                // Iterate over the response data, which contains contact person names
                $.each(response, function (index, contact) {
                    // Append each contact person as an option in the dropdown
                    $('#Suppliercontact').append('<option value="' + contact + '">' + contact + '</option>');
                });
            },
            error: function () {  // Function executed if the request fails
                console.error('Failed to fetch contacts.');
            }
        });
    });
</script>
{% include "alert.html" %}
{%include 'date.html'%}
{% extends "uppercase.html"%}