<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>OmniPro Systems Pvt Ltd</title>
        <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">

        <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
        <link href="https://cdn.datatables.net/1.10.20/css/dataTables.bootstrap4.min.css" rel="stylesheet" crossorigin="anonymous" />
        <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/js/all.min.js" crossorigin="anonymous"></script>
        <link href="https://fonts.googleapis.com/css2?family=Lora:wght@700&display=swap" rel="stylesheet">
        <style>


        </style>
    </head>
    <body class="sb-nav-fixed">
        {%include "header.html"%}

                <main>
                    
                           
                            <form action="{{url_for('Employee')}}" method="POST">
                                        
                                        
                                       
                                
                                    <div id="dialog" class="modal">
                                        <div class="modal-content">
                                            <span class="close">&times;</span>
                                            <h2>Add New Employee</h2>
                                            <form id="studentForm">
                                                <div class="form-row">
                                                    <div class="form-group col-md-3">
                                                        <label for="employeename"><b>Employee Name:</b></label>
                                                        <input type="text" class="form-control" id="employeename" name="employeename" placeholder="Enter employee name" required onblur="checkEmployeeName()">
                                                        <!-- <small id="customernameHelp" class="form-text text-muted">Please enter a customer name with uppercase letters only.</small> -->
                                                        <div id="nameError" class="text-danger"></div>
                                                    </div>
                                                    <div class="form-group col-md-3">
                                                        <label for="joiningdate"><b>joining Date:</b></label>
                                                        <input type="date" class="form-control" id="joiningdate" name="joiningdate" max="{{ max_date }}">
                                                    </div>
                                                    <div class="form-group col-md-3">
                                                        <label for="designation"><b>Designation:</b></label>
                                                        <!-- Button to open the Add Designation modal -->
                                                        <button type="button" id="addDesignation" data-toggle="modal" data-target="#designationModal" 
                                                                style="background-color: #007bff; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">
                                                            +
                                                        </button>
                                                    
                                                        <!-- Text input field for filtering designations -->
                                                        <input type="text" id="designationFilter" class="form-control" placeholder="Enter designation" autocomplete="off" required>
                                                    
                                                        <!-- Dropdown for displaying filtered designations -->
                                                        <ul id="designationList" class="list-group" style="position: absolute; z-index: 1000; display: none; max-height: 200px; overflow-y: auto; width: 100%; border: 1px solid #ccc; border-radius: 5px; background-color: white; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);">
                                                            {% for designation in designation_data %}
                                                            <li class="list-group-item" style="cursor: pointer; padding: 10px; border-bottom: 1px solid #eee;">{{ designation[1] }}</li>
                                                            {% endfor %}
                                                        </ul>
                                                    
                                                        <!-- Hidden select field for form submission -->
                                                        <select class="form-control" id="designationSelect" name="designation" style="display: none;">
                                                            <option value="" disabled selected>Select a Designation</option>
                                                            {% for designation in designation_data %}
                                                            <option value="{{ designation[1] }}">{{ designation[1] }}</option>
                                                            {% endfor %}
                                                        </select>
                                                    </div>
                                                    <div class="form-group col-md-3">
                                                        <label for="dateofbirth"><b>Date of Birth:</b></label>
                                                        <input type="date" class="form-control" id="dateofbirth" name="dateofbirth" max="{{ max_date }}">
                                                    </div>
                                                 
                                                </div>
                                                <div class="form-row">
                                                   
                                                    <div class="form-group col-md-3">
                                                        <label for="bloodgroup"><b>Blood Group:</b></label>
                                                        <input type="text" class="form-control" id="bloodgroup" name="bloodgroup" placeholder="Enter bloodgroup" required>
                                                    </div>
                                                    <div class="form-group col-md-3">
                                                        <label for="qualification"><b>Qualification:</b></label>
                                                        <input type="text" class="form-control" id="qualification" name="qualification">
                                                    </div>
                                                    <div class="form-group col-md-3">
                                                        <label for="gender"><b>Gender:</b></label>
                                                        <select class="form-control" id="gender" name="gender">
                                                            <option value="Gender">--Select Gender--</option>
                                                            <option value="Male">Male</option>
                                                            <option value="Female">Female</option>
                                                            <!-- <option value="Gender3">Transgender</option> -->
                                                           <!-- Add more options as needed -->
                                                         </select>
                                                    </div>
                                                    <div class="form-group col-md-3">
                                                        <label for="address"><b>Address:</b></label>
                                                        <textarea class="form-control" id="address" name="address" placeholder="Enter address" rows="3"></textarea>
                                                    </div>
                                                    

                                                </div>
                                                <div class="form-row">
                                                    
                                                   
                                                  
                                                    <div class="form-group col-md-3">
                                                        <label for="contactnumber"><b>Contact Number:</b></label>
                                                        <input type="text" id="contactnumber" class="form-control" name="contactnumber" maxlength="16">
                                                        <small class="form-text text-muted">Please enter a 10-digit contact number using only digits (0-9).</small>
                                                    </div>
                                                    <div class="form-group col-md-3">
                                                        <label for="alternatenumber"><b>Alternate Number:</b></label>
                                                        <input type="text" id="alternatenumber" class="form-control" name="alternatenumber" maxlength="16">
                                                        <small class="form-text text-muted">Please enter a 10-digit contact number using only digits (0-9).</small>
                                                    </div>
                                                    
                                                    <div class="form-group col-md-3">
                                                        <label for="city"><b>City:</b></label>
                                                        <button type="button" id="addCity" data-toggle="modal" data-target="#cityModal" style="background-color: #007bff; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">
                                                            +
                                                        </button>
                                                    
                                                        <!-- Text input field for filtering cities -->
                                                        <input type="text" id="cityFilter" class="form-control" placeholder="Enter city name" autocomplete="off" required>
                                                    
                                                        <!-- Dropdown for displaying filtered cities -->
                                                        <ul id="cityList" class="list-group" style="position: absolute; z-index: 1000; display: none; max-height: 200px; overflow-y: auto; width: 100%; border: 1px solid #ccc; border-radius: 5px; background-color: white; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);">
                                                            {% for city in data %}
                                                            <li class="list-group-item" style="cursor: pointer; padding: 10px; border-bottom: 1px solid #eee;">{{ city[1] }}</li>
                                                            {% endfor %}
                                                        </ul>
                                                    
                                                        <!-- Hidden select field for form submission -->
                                                        <select class="form-control" id="city" name="city" style="display: none;">
                                                            <option value="" disabled selected>Select a City</option>
                                                            {% for city in data %}
                                                            <option value="{{ city[1] }}">{{ city[1] }}</option>
                                                            {% endfor %}
                                                        </select>
                                                    </div>
                                                    <div class="form-group col-md-3">
                                                        <label for="branch"><b>Branch:</b></label>
                                                        <button type="button" id="addBranch" data-toggle="modal" data-target="#branchModal" style="background-color: #007bff; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">
                                                            +
                                                        </button>
                                                    
                                                        <!-- Text input field for filtering branches -->
                                                        <input type="text" id="branchFilter" class="form-control" placeholder="Enter branch name" autocomplete="off" required>
                                                    
                                                        <!-- Dropdown for displaying filtered branches -->
                                                        <ul id="branchList" class="list-group" style="position: absolute; z-index: 1000; display: none; max-height: 200px; overflow-y: auto; width: 100%; border: 1px solid #ccc; border-radius: 5px; background-color: white; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);">
                                                            {% for branch in value %}
                                                            <li class="list-group-item" style="cursor: pointer; padding: 10px; border-bottom: 1px solid #eee;">{{ branch[1] }}</li>
                                                            {% endfor %}
                                                        </ul>
                                                    
                                                        <!-- Hidden select field for form submission -->
                                                        <select class="form-control" id="branch" name="branch" style="display:none;">
                                                            <option value="" disabled selected>Select a Branch</option>
                                                            {% for branch in value %}
                                                            <option value="{{ branch[1] }}">{{ branch[1] }}</option>
                                                            {% endfor %}
                                                        </select>
                                                    </div>
                                      
                                                </div>
                                              
                                                <div class="form-row">
                                                   
                                                    
                                                    <div class="form-group col-md-3">
                                                        <label for="email"><b>Email:</b></label>
                                                        <input type="text" class="form-control" id="email" name="email">
                                                    </div>
                                                    <div class="form-group col-md-3">
                                                        <label for="skype"><b>Skype:</b></label>
                                                        <input type="text" class="form-control" id="skype" name="skype">
                                                    </div>
                                                  
                                                    <div class="form-group col-md-3">
                                                        <label for="remarks"><b>Remarks:</b></label>
                                                        <textarea class="form-control" id="remarks" name="remarks" placeholder="Enter remarks" rows="3"></textarea>
                                                    </div>
                                                    <div class="form-group col-md-3">
                                                        <label for="updateddate"><b>Updated Date:</b></label>
                                                        <input type="date" class="form-control" id="updateddate" name="updateddate"max="{{ max_date }}">
                                                    </div>
                                                    <button type="submit" class="btn11 btn-primary borde">Submit</button>
                                                </div>
                                               
                                                </div>
                                                
                                                </div><br>
                                                <!-- <button type="submit" class="btn11 btn-success borde">Add</button> -->
                                            </form>
                                       
                                
                                            <div class="card mb-4">
                                            
                                                <div class="card-header" style="padding: 5px 10px; height: 50px;">
                                                    <div class="d-flex justify-content-between align-items-center h-100">
                                                        <!-- Left-side buttons (Add, Contacts, Export) -->
                                                        <div class="d-flex align-items-center" style="gap: 10px;">
                                                            <button id="addNewBtn" type="button" class="btn btn-primary" 
                                                                    style="padding: 5px 10px; font-size: 0.85rem; border-radius: 5px;">
                                                                <i class="fas fa-plus"></i> Add
                                                            </button>
                                                            
                                                            <a href="{{ url_for('export_employee_data') }}">
                                                                <button type="button" class="btn btn-success" 
                                                                        style="padding: 5px 10px; font-size: 0.85rem; border-radius: 5px;">
                                                                    Export
                                                                </button>
                                                            </a>
                                                        </div>
                                                        <h2 style="color: #20B2AA;"> EMPLOYEES</h2>
                                                        <!-- Right-side Search form -->
                                                        <div class="d-flex align-items-center">
                                                            <form method="GET" action="{{ url_for('Employee') }}" class="d-flex align-items-center" enctype="multipart/form-data" style="gap: 5px;">
                                                                <label for="search" class="mb-0" style="margin-right: 5px; font-size: 0.85rem;">Search:</label>
                                                                <input type="text" id="search" name="search" value="{{ search_query }}" 
                                                                       class="form-control form-control-sm" style="padding: 5px; font-size: 0.85rem; border-radius: 5px;">
                                                                <button type="submit" class="btn btn-primary" style="padding: 5px 10px; font-size: 0.85rem; border-radius: 5px;">
                                                                    Search
                                                                </button>
                                                            </form>
                                                        </div>
                                                    </div>
                                                </div>
                                                    
                                            
                                            
                                        <!-- <div class="card-body"> -->
                                            <div class="table-responsive">
                                                <table class="table table-bordered " id="dataTable" width="100%" cellspacing="0">
                                                    <thead>
                                                        <tr>
                                                            <th scope="col">S.No</th>
                                                            <th scope="col">Employee Name</th>
                                                            <th scope="col">Joining Date</th>
                                                            <th scope="col">Designation</th>
                                                            <th scope="col">DOB</th>
                                                            <th scope="col">Blood Group</th>
                                                            <th scope="col">Qualification</th>
                                                            <th scope="col">Gender</th>
                                                            <th scope="col">Address</th>
                                                            <th scope="col">Contact No</th>
                                                            <th scope="col">Alternate No</th>
                                                            <th scope="col">City</th>
                                                            <th scope="col">State</th>
                                                            <th scope="col">Email</th>
                                                            <th scope="col">Skype</th>
                                                            <th scope="col">Remarks</th>
                                                            <th scope="col">Updated Date</th>
                                                            <th scope="col" style="padding: 30px;">Action</th>
                                                        </tr>
                                                    </thead>
                                                    
                                                    <tbody>
                                                        {% for record in employee %}
                                                        <tr>
                                                            <td>{{ loop.index}}</td>
                                                            <td class="{% if record[17] == 0 %} text-danger {% endif %}">{{ record[1] }}</td>
                                                            <td>{{ record[2] }}</td>
                                                            <td>{{ record[3] }}</td>
                                                            <td>{{ record[4] }}</td>
                                                            <td>{{ record[5] }}</td>
                                                            <td>{{ record[6] }}</td>
                                                            <td>{{ record[7] }}</td>
                                                            <td>{{ record[8] }}</td>
                                                            <td>{{ record[9] }}</td>
                                                            <td>{{ record[10] }}</td>
                                                            <td>{{ record[11] }}</td>
                                                            <td>{{ record[12] }}</td>
                                                            <td>{{ record[13] }}</td>
                                                            <td>{{ record[14] }}</td>
                                                            <td>{{ record[15] }}</td>
                                                            <td>{{ record[16] }}</td>
                                                            
                                                            <td>
                                                                <!-- Edit Button -->
                                                                <a href="/update_employee/{{record.0}}" class="btn btn-warning btn-sm"
                                                                   data-toggle="modal" data-target="#modaledit{{record.0}}"
                                                                   style="position: relative; display: inline-block; cursor: pointer;"
                                                                   onmouseover="this.querySelector('.tooltiptext').style.visibility = 'visible'; this.querySelector('.tooltiptext').style.opacity = '1';"
                                                                   onmouseout="this.querySelector('.tooltiptext').style.visibility = 'hidden'; this.querySelector('.tooltiptext').style.opacity = '0';">
                                                                   <i class="fas fa-edit"></i>
                                                                   <span class="tooltiptext" style="
                                                                       visibility: hidden;
                                                                       width: 100px;
                                                                       background-color: black;
                                                                       color: #fff;
                                                                       text-align: center;
                                                                       border-radius: 5px;
                                                                       padding: 5px;
                                                                       position: absolute;
                                                                       z-index: 1;
                                                                       bottom: 125%;
                                                                       left: 50%;
                                                                       margin-left: -50px;
                                                                       opacity: 0;
                                                                       transition: opacity 0.3s;
                                                                   ">Edit</span>
                                                                </a>
                                                                
                                                                <!-- Delete Button -->
                                                                <a href="/delete_employee/{{ record.0 }}" onclick="return confirm('Are you sure you want to delete?');" class="btn btn-danger btn-sm"
                                                                   style="position: relative; display: inline-block; cursor: pointer;"
                                                                   onmouseover="this.querySelector('.tooltiptext').style.visibility = 'visible'; this.querySelector('.tooltiptext').style.opacity = '1';"
                                                                   onmouseout="this.querySelector('.tooltiptext').style.visibility = 'hidden'; this.querySelector('.tooltiptext').style.opacity = '0';">
                                                                   <i class="fas fa-trash-alt"></i>
                                                                   <span class="tooltiptext" style="
                                                                       visibility: hidden;
                                                                       width: 100px;
                                                                       background-color: black;
                                                                       color: #fff;
                                                                       text-align: center;
                                                                       border-radius: 5px;
                                                                       padding: 5px;
                                                                       position: absolute;
                                                                       z-index: 1;
                                                                       bottom: 125%;
                                                                       left: 50%;
                                                                       margin-left: -50px;
                                                                       opacity: 0;
                                                                       transition: opacity 0.3s;
                                                                   ">Delete</span>
                                                                </a>
                                                            </td>
                                                            
                                                       </tr>
                                                       <div id="modaledit{{ record[0] }}" class="modal fade" role="dialog">
                                                        <div class="modal-dialog">
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h4 class="modal-title">Update lead</h4>
                                                                </div>
                                                                <div class="modal-body">
                                                                    <form action="{{ url_for('update_employee') }}" method="POST">
                                                                        <input type="hidden" name="id" value="{{ record[0] }}">
                                                                        <div class="form-group">
                                                                            <label>Employee Name</label>
                                                                            <input type="text" class="form-control" name="employeename" value="{{ record[1] }}" >
                                                                        </div>
                                                                        <div class="form-group">
                                                                            <label>joining Date</label>
                                                                            <input type="date" class="form-control" name="joiningdate" value="{{ record[2] }}" max="{{ max_date }}">
                                                                        </div>
                                                                        <div class="form-group">
                                                                            <label>Designation</label>
                                                                            <input type="text" class="form-control" name="designation" value="{{ record[3] }}" >
                                                                        </div>
                                                                        <div class="form-group">
                                                                            <label>Date of Birth</label>
                                                                            <input type="date" class="form-control" name="dateofbirth" value="{{ record[4] }}"max="{{ max_date }}" >
                                                                        </div>
                                                                        <div class="form-group">
                                                                            <label>Blood Group</label>
                                                                            <input type="text" class="form-control" name="bloodgroup" value="{{ record[5] }}" >
                                                                        </div>
                                                                        <div class="form-group">
                                                                            <label>Qualification</label>
                                                                            <input type="text" class="form-control" name="qualification" value="{{ record[6] }}" >
                                                                        </div>
                                                                        <div class="form-group">
                                                                            <label>Gender</label>
                                                                            <input type="text" class="form-control" name="gender" value="{{ record[7] }}" >
                                                                        </div>
                                                                        <div class="form-group">
                                                                            <label>Address</label>
                                                                            <input type="text" class="form-control" name="address" value="{{ record[8] }}" >
                                                                        </div>
                                                                        <div class="form-group">
                                                                            <label>Contact No</label>
                                                                            <input type="text" class="form-control" name="contactnumber" value="{{ record[9] }}" >
                                                                        </div>
                                                                        <div class="form-group">
                                                                            <label>Alternate No</label>
                                                                            <input type="text" class="form-control" name="alternatenumber" value="{{ record[10] }}" >
                                                                        </div>
                                                                        <div class="form-group">
                                                                            <label>City</label>
                                                                            <input type="text" class="form-control" name="city" value="{{ record[11] }}" >
                                                                        </div>
                                                                        <div class="form-group">
                                                                            <label>State</label>
                                                                            <input type="text" class="form-control" name="state" value="{{ record[12] }}" >
                                                                        </div>
                                                                        <div class="form-group">
                                                                            <label>Email</label>
                                                                            <input type="text" class="form-control" name="email" value="{{ record[13] }}" >
                                                                        </div>
                                                                        <div class="form-group">
                                                                            <label>Skype</label>
                                                                            <input type="text" class="form-control" name="skype" value="{{ record[14] }}" >
                                                                        </div>
                                                                        <div class="form-group">
                                                                            <label>Remarks</label>
                                                                            <input type="text" class="form-control" name="remarks" value="{{ record[15] }}" >
                                                                        </div>
                                                                        <div class="form-group">
                                                                            <label>Updated Date</label>
                                                                            <input type="date" class="form-control" name="updateddate" value="{{ record[16] }}" max="{{ max_date }}">
                                                                        </div>
                                                                        
                                                                        
                                                                        
                                                                        <button type="submit" class="btn btn-primary">Update</button>
                                                                    </form>
                                                                </div>
                                                                <div class="modal-footer">
                                                                    <button class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                        {% endfor %}
                                                        <!-- <tr>
                                                            <td>2</td>
                                                            
                                                            <td>123-456-7890</td>
                                                            <td>123-456-7890</td>
                                                            <td>123-456-7890</td>
                                                            
                                                           
                                                        </tr> -->
                                                        
                                                       
                                                       
                                                        
                                                    </tbody>
                                                </table>
                                                <ul class="pagination" style="display: flex;justify-content: flex-end;padding: 20px;">
                                                    {% if page > 1 %}
                                                    <li><a href="{{ url_for('Employee', page=1, search=search_query) }}">First</a></li>
                                                    <li><a href="{{ url_for('Employee', page=page-1, search=search_query) }}">Previous</a></li>
                                                    {% endif %}
                                                    {% for p in range(1, total_pages + 1) %}
                                                    <li><a href="{{ url_for('Employee', page=p, search=search_query) }}">{{ p }}</a></li>
                                                    {% endfor %}
                                                    {% if page < total_pages %}
                                                    <li><a href="{{ url_for('Employee', page=page+1, search=search_query) }}">Next</a></li>
                                                    <li><a href="{{ url_for('Employee', page=total_pages, search=search_query) }}">Last</a></li>
                                                    {% endif %}
                                                </ul>
                                            </div>
                                           
                                        <!-- </div> -->
                                        
                                    </div>
                                    
                                </div>
                                
                            </div>
                          </div>
                            
                                  </form>
                                  
                                 
                
                                 
                        </main>
                        {% include "footer.html"%}

                        <div class="modal fade" id="cityModal" tabindex="-1" role="dialog" aria-labelledby="cityModalLabel" aria-hidden="true">
                            <div class="modal-dialog" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="cityModalLabel">Add New City</h5>
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    <div class="modal-body">
                                        <form id="cityForm">
                                            <div class="form-group">
                                                <label for="cityName">City Name</label>
                                                <input type="text" class="form-control" id="cityName" name="cityName" required>
                                            </div>
                                        </form>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-primary" id="saveCity">Save City</button>
                        
                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="branchModal" class="modal fade" tabindex="-1" role="dialog">
                            <div class="modal-dialog" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title">Add New Branch</h5>
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    <div class="modal-body">
                                        <input type="text" id="branchName" class="form-control" placeholder="Enter new branch name">
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" id="saveBranch" class="btn btn-primary">Save Branch</button>
                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Modal for adding new designation -->
<div class="modal fade" id="designationModal" tabindex="-1" role="dialog" aria-labelledby="designationModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="designationModalLabel">Add New Designation</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="designationForm">
                    <div class="form-group">
                        <label for="designationName">Designation Name</label>
                        <input type="text" class="form-control" id="designationName" name="designationName" required>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="saveDesignation">Save Designation</button>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div><script>
    // Convert input to uppercase
    const designationNameInput = document.getElementById('designationName');
    designationNameInput.addEventListener('input', () => {
        designationNameInput.value = designationNameInput.value.toUpperCase();
    });
    
    // Function to check if a designation already exists in the dropdown or list
    function designationExists(designationName) {
        var designationOptions = document.querySelectorAll('#designationSelect option');
        for (var option of designationOptions) {
            if (option.value.toUpperCase() === designationName.toUpperCase()) {
                return true;
            }
        }
        var designationItems = document.querySelectorAll('#designationList li');
        for (var item of designationItems) {
            if (item.textContent.toUpperCase() === designationName.toUpperCase()) {
                return true;
            }
        }
        return false;
    }
    
    // Handle saving a new designation
    document.getElementById('saveDesignation').addEventListener('click', function () {
        var designationName = document.getElementById('designationName').value;
    
        if (designationName) {
            if (designationExists(designationName)) {
                alert('This designation already exists.');
                return; // Prevent further action
            }
    
            var xhr = new XMLHttpRequest();
            xhr.open('POST', '/add_designation', true);
            xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
            xhr.onload = function () {
                if (xhr.status === 200) {
                    var response = JSON.parse(xhr.responseText);
                    if (response.success) {
                        // Add the new designation to the dropdown
                        var designationSelect = document.getElementById('designationSelect');
                        var newOption = document.createElement("option");
                        newOption.value = response.designation_name; // Only designation name
                        newOption.text = response.designation_name;   // Only designation name
                        designationSelect.appendChild(newOption);
    
                        // Add the new designation to the filter list
                        var designationList = document.getElementById('designationList');
                        var newListItem = document.createElement("li");
                        newListItem.className = "list-group-item";
                        newListItem.textContent = response.designation_name; // Only designation name
                        designationList.appendChild(newListItem);
    
                        // Clear the input and hide the modal
                        document.getElementById('designationName').value = '';
                        $('#designationModal').modal('hide');
                    }
                } else {
                    console.error('Error adding designation:', xhr.responseText);
                }
            };
            xhr.send('designationName=' + encodeURIComponent(designationName));
        } else {
            alert('Please enter a designation name');
        }
    });
    
    // JavaScript to filter designations based on input
    document.getElementById('designationFilter').addEventListener('input', function() {
        var filter = this.value.toLowerCase();
        var list = document.getElementById('designationList');
        var items = list.getElementsByTagName('li');
    
        for (var i = 0; i < items.length; i++) {
            var item = items[i];
            var option = item.textContent.toLowerCase();
    
            if (option.startsWith(filter)) {
                item.style.display = ''; // Show item
            } else {
                item.style.display = 'none'; // Hide item
            }
        }
    
        // Show the list if there's input; otherwise, show all items
        if (filter === '') {
            for (var i = 0; i < items.length; i++) {
                items[i].style.display = ''; // Show all items
            }
        }
    });
    
    // Handle click on a designation item
    document.getElementById('designationList').addEventListener('click', function(e) {
        if (e.target.tagName === 'LI') {
            document.getElementById('designationFilter').value = e.target.textContent;
            document.getElementById('designationSelect').value = e.target.textContent; // Set the value of the hidden select field
            this.style.display = 'none'; // Hide the list after selection
        }
    });
    
    // Close the dropdown if clicked outside
    document.addEventListener('click', function(e) {
        var list = document.getElementById('designationList');
        var filter = document.getElementById('designationFilter');
    
        if (!filter.contains(e.target) && !list.contains(e.target)) {
            list.style.display = 'none';
        }
    });
    
    // Show the list when the input field is focused
    document.getElementById('designationFilter').addEventListener('focus', function() {
        document.getElementById('designationList').style.display = 'block';
    });
    </script>
                       
                        <script>
                             document.addEventListener('DOMContentLoaded', () => {
                                const addRowBtn = document.getElementById('addRowBtn');
                                const productTable = document.getElementById('productTable').getElementsByTagName('tbody')[0];
                                let rowCount = 0;
                            
                                addRowBtn.addEventListener('click', addRow);
                            
                                function addRow() {
                                    rowCount++;
                                    const row = productTable.insertRow();
                            
                                    row.innerHTML = `
                                    <td><input type="text" min="0" class="ContactPerson" placeholder="ContactPerson"></td>
                                    <td><input type="text" min="0" class="Contactnumber" placeholder="Contactnumber"></td>
                                    <td><input type="text" min="0" class="Department" placeholder="Department"></td>
                                     <td><input type="text" min="0" class="Whatsapp" placeholder="Whatsapp"></td>
                                    <td><input type="email" min="0" class="email" placeholder="email"></td>
                                    <td><input type="text" min="0" class="skype" placeholder="skype"></td>
                                    <td>
                                        <select>
                                        <option value="Supplier1">Supplier1</option>
                                        <option value="Supplier2">Supplier2</option>
                                        <option value="Supplier3">Supplier1</option>
                                    </select>
                                    <td><input type="Date" min="0" class="Date" placeholder="Date"></td>
                                    <td><button class="delete-btn btn-danger">X</button></td>
                                    `;
                            
                                    const deleteBtn = row.querySelector('.delete-btn');
                                    deleteBtn.addEventListener('click', () => {
                                        row.remove();
                                        // updateRowNumbers();
                                    });
                            
                                    const totalQuantityInput = row.querySelector('.total-quantity');
                                    const priceInput = row.querySelector('.price');
                                    const orderQuantityInput = row.querySelector('.order-quantity');
                                    const totalPriceInput = row.querySelector('.total-price');
                            
                                    totalQuantityInput.addEventListener('input', updateTotalPrice);
                                    priceInput.addEventListener('input', updateTotalPrice);
                                    orderQuantityInput.addEventListener('input', updateTotalPrice);
                                }
                            
                                function updateRowNumbers() {
                                    rowCount = 0;
                                    const rows = productTable.getElementsByTagName('tr');
                                    for (let row of rows) {
                                        rowCount++;
                                        row.cells[0].textContent = rowCount;
                                    }
                                }
                            
                                function updateTotalPrice() {
                                    const row = this.closest('tr');
                                    const totalQuantity = parseFloat(row.querySelector('.total-quantity').value) || 0;
                                    const price = parseFloat(row.querySelector('.price').value) || 0;
                                    const orderQuantity = parseFloat(row.querySelector('.order-quantity').value) || 0;
                                    const totalPrice = price * orderQuantity;
                                    row.querySelector('.total-price').value = totalPrice.toFixed(2);
                                }
                            
                                // Initialize the first row
                                addRow();
                            });
                            document.addEventListener('DOMContentLoaded', () => {
                                const addNewBtn = document.getElementById('addNewBtn');
                                const modal = document.getElementById('dialog');
                                const span = document.getElementsByClassName('close')[0];
                                const form = document.getElementById('studentForm');
                                const tableBody = document.querySelector('#studentTable tbody');
                                const entriesSelect = document.getElementById('entriesSelect');
                                const searchInput = document.getElementById('searchInput');
                                const pagination = document.getElementById('pagination');
                            
                                let students = [];
                                let currentPage = 1;
                                let entriesPerPage = 10;
                            
                                function renderTable() {
                                    tableBody.innerHTML = '';
                                    const filteredStudents = students.filter(student => 
                                        student.name.toLowerCase().includes(searchInput.value.toLowerCase()) ||
                                        student.gender.toLowerCase().includes(searchInput.value.toLowerCase()) ||
                                        student.phoneNumber.toLowerCase().includes(searchInput.value.toLowerCase())
                                    );
                                    const totalEntries = filteredStudents.length;
                                    const totalPages = Math.ceil(totalEntries / entriesPerPage);
                                    const start = (currentPage - 1) * entriesPerPage;
                                    const end = start + entriesPerPage;
                                    const pageStudents = filteredStudents.slice(start, end);
                            
                                    pageStudents.forEach(student => {
                                       
                                        newRow.querySelector('.deleteBtn').addEventListener('click', function() {
                                            students = students.filter(s => s !== student);
                                            renderTable();
                                        });
                                    });
                            
                                    renderPagination(totalPages);
                                }
                            
                                function renderPagination(totalPages) {
                                    pagination.innerHTML = '';
                                    for (let i = 1; i <= totalPages; i++) {
                                        const button = document.createElement('button');
                                        button.classList.add('pagination-button');
                                        button.textContent = i;
                                        button.addEventListener('click', () => {
                                            currentPage = i;
                                            renderTable();
                                        });
                                        pagination.appendChild(button);
                                    }
                                }
                            
                                addNewBtn.onclick = function() {
                                    modal.style.display = 'block';
                                }
                            
                                span.onclick = function() {
                                    modal.style.display = 'none';
                                }
                            
                                window.onclick = function(event) {
                                    if (event.target == modal) {
                                        modal.style.display = 'none';
                                    }
                                }
                            
                                
                            
                                entriesSelect.addEventListener('change', function() {
                                    entriesPerPage = parseInt(entriesSelect.value, 10);
                                    currentPage = 1;
                                    renderTable();
                                });
                            
                                searchInput.addEventListener('input', function() {
                                    currentPage = 1;
                                    renderTable();
                                });
                            
                                renderTable();
                            });
                            document.getElementById('uploadForm').addEventListener('submit', function(event) {
            event.preventDefault(); // Prevent the form from submitting normally
            var formData = new FormData(this);

            fetch('/upload', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    document.getElementById('message').innerText = "File uploaded successfully!";
                } else {
                    document.getElementById('message').innerText = "File upload failed!";
                }
            })
            .catch(error => {
                console.error('Error:', error);
                document.getElementById('message').innerText = "An error occurred!";
            });
        });
                        </script>
                        <script>
                            document.getElementById('excelFile').addEventListener('change', handleFileUpload);
                        
                            function handleFileUpload(event) {
                                const file = event.target.files[0];
                                const reader = new FileReader();
                        
                                reader.onload = function (e) {
                                    const data = new Uint8Array(e.target.result);
                                    const workbook = XLSX.read(data, { type: 'array' });
                        
                                    // Assuming the first sheet
                                    const firstSheetName = workbook.SheetNames[0];
                                    const worksheet = workbook.Sheets[firstSheetName];
                        
                                    const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
                        
                                    // Assuming the table has the same structure as the excel data
                                    const tableBody = document.querySelector('#productTable tbody');
                                    tableBody.innerHTML = ''; // Clear existing rows
                        
                                    jsonData.forEach((row, index) => {
                                        if (index > 0) { // Skip the header row
                                            const newRow = document.createElement('tr');
                                            row.forEach(cell => {
                                                const newCell = document.createElement('td');
                                                newCell.textContent = cell;
                                                newRow.appendChild(newCell);
                                            });
                        
                                            const actionCell = document.createElement('td');
                                            actionCell.innerHTML = '<button onclick="removeRow(this)">Remove</button>';
                                            newRow.appendChild(actionCell);
                        
                                            tableBody.appendChild(newRow);
                                        }
                                    });
                                };
                        
                                reader.readAsArrayBuffer(file);
                            }
                        
                            function removeRow(button) {
                                const row = button.parentNode.parentNode;
                                row.parentNode.removeChild(row);
                            }
                        </script>
                
            <!-- </div>
        </div> -->
        <script src="https://code.jquery.com/jquery-3.5.1.min.js" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
        <script src="js/scripts.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js" crossorigin="anonymous"></script>
        <script src="assets/demo/chart-area-demo.js"></script>
        <script src="assets/demo/chart-bar-demo.js"></script>
        <script src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js" crossorigin="anonymous"></script>
        <script src="https://cdn.datatables.net/1.10.20/js/dataTables.bootstrap4.min.js" crossorigin="anonymous"></script>
        <script src="assets/demo/datatables-demo.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
        <script>
            $(document).ready(function() {
                // Set the active link on page load based on the current URL
                var currentPath = window.location.pathname;
                $('.sb-sidenav .nav-link').each(function() {
                    var linkPath = $(this).attr('href');
                    if (currentPath.indexOf(linkPath) !== -1) {
                        $(this).addClass('active');
                    }
                });
        
                // Update the active link on click
                $('.sb-sidenav .nav-link').on('click', function() {
                    $('.sb-sidenav .nav-link').removeClass('active');
                    $(this).addClass('active');
                });
            });
        </script>

        <script>
            function checkEmployeeName(event) {
    var employeename = document.getElementById('employeename').value;
    if (employeename) {
        var xhr = new XMLHttpRequest();
        xhr.open('POST', '/check_employee_name', true);
        xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
        xhr.onload = function () {
            if (xhr.status === 200) {
                var response = JSON.parse(xhr.responseText);
                var nameError = document.getElementById('nameError');
                var employeenameHelp = document.getElementById('employeenameHelp');
                if (response.exists) {
                    nameError.textContent = 'Employee name already exists. Please choose a different name.';
                    employeenameHelp.style.display = 'none';
                    event.preventDefault(); // Prevent form submission
                } else {
                    nameError.textContent = '';
                    employeenameHelp.style.display = 'block';
                }
            }
        };
        xhr.send('employeename=' + encodeURIComponent(employeename));
    }
}

// Attach the checkEmployeeName function to the form submit event
document.getElementById('employeeForm').addEventListener('submit', function(event) {
    checkEmployeeName(event);
});


        </script>
        <script>
            document.getElementById('contactnumber').addEventListener('input', function (e) {
                this.value = this.value.replace(/[^0-9+-]/g, '');  // Allow digits, + and - symbols
                if (this.value.length > 10) {
                    this.value = this.value.slice(0, 16);  // Enforce max length of 10 characters
                }
            });
        </script>
        <script>
            document.getElementById('alternatenumber').addEventListener('input', function (e) {
                this.value = this.value.replace(/[^0-9+-]/g, '');  // Allow digits, + and - symbols
                if (this.value.length > 10) {
                    this.value = this.value.slice(0, 16);  // Enforce max length of 10 characters
                }
            });
        </script>
        <script>
            // Convert input to uppercase
            const cityNameInput = document.getElementById('cityName');
            cityNameInput.addEventListener('input', () => {
                cityNameInput.value = cityNameInput.value.toUpperCase();
            });
        
            // Function to check if a city already exists in the dropdown and list
            function cityExists(cityName) {
                var cityOptions = document.querySelectorAll('#city option');
                for (var option of cityOptions) {
                    if (option.value.toUpperCase() === cityName.toUpperCase()) {
                        return true;
                    }
                }
                var cityItems = document.querySelectorAll('#cityList li');
                for (var item of cityItems) {
                    if (item.textContent.toUpperCase() === cityName.toUpperCase()) {
                        return true;
                    }
                }
                return false;
            }
        
            // Handle saving a new city
            document.getElementById('saveCity').addEventListener('click', function () {
                var cityName = document.getElementById('cityName').value;
        
                if (cityName) {
                    if (cityExists(cityName)) {
                        alert('This city already exists.');
                        return; // Prevent further action
                    }
        
                    var xhr = new XMLHttpRequest();
                    xhr.open('POST', '/add_city', true);
                    xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
                    xhr.onload = function () {
                        if (xhr.status === 200) {
                            var response = JSON.parse(xhr.responseText);
                            if (response.success) {
                                // Add the new city to the dropdown
                                var citySelect = document.getElementById('city');
                                var newOption = document.createElement("option");
                                newOption.value = response.city_name;
                                newOption.text = response.city_name;
                                citySelect.appendChild(newOption);
        
                                // Add the new city to the filter list
                                var cityList = document.getElementById('cityList');
                                var newListItem = document.createElement("li");
                                newListItem.className = "list-group-item";
                                newListItem.textContent = response.city_name;
                                newListItem.style.cursor = "pointer";
                                newListItem.style.padding = "10px";
                                newListItem.style.borderBottom = "1px solid #eee";
                                cityList.appendChild(newListItem);
        
                                // Clear the input and hide the modal
                                document.getElementById('cityName').value = ''; 
                                $('#cityModal').modal('hide'); // Hide the modal
                            }
                        } else {
                            console.error('Error adding city:', xhr.responseText);
                        }
                    };
                    xhr.send('cityName=' + encodeURIComponent(cityName));
                } else {
                    alert('Please enter a city name');
                }
            });
        
            // JavaScript to filter city options based on input
            document.getElementById('cityFilter').addEventListener('input', function() {
                var filter = this.value.toLowerCase();
                var list = document.getElementById('cityList');
                var items = list.getElementsByTagName('li');
        
                for (var i = 0; i < items.length; i++) {
                    var item = items[i];
                    var option = item.textContent.toLowerCase();
        
                    if (option.startsWith(filter)) {
                        item.style.display = ''; // Show item
                    } else {
                        item.style.display = 'none'; // Hide item
                    }
                }
        
                // Show the list if there's input; otherwise, show all items
                if (filter === '') {
                    for (var i = 0; i < items.length; i++) {
                        items[i].style.display = ''; // Show all items
                    }
                }
            });
        
            // Handle click on a city item
            document.getElementById('cityList').addEventListener('click', function(e) {
                if (e.target.tagName === 'LI') {
                    document.getElementById('cityFilter').value = e.target.textContent;
                    document.getElementById('city').value = e.target.textContent; // Set the value of the hidden select field
                    this.style.display = 'none'; // Hide the list after selection
                }
            });
        
            // Close the dropdown if clicked outside
            document.addEventListener('click', function(e) {
                var list = document.getElementById('cityList');
                var filter = document.getElementById('cityFilter');
        
                if (!filter.contains(e.target) && !list.contains(e.target)) {
                    list.style.display = 'none';
                }
            });
        
            // Show the list when the input field is focused
            document.getElementById('cityFilter').addEventListener('focus', function() {
                document.getElementById('cityList').style.display = 'block';
            });
        </script>
        <script>
            // Convert input to uppercase
            const branchNameInput = document.getElementById('branchName');
            branchNameInput.addEventListener('input', () => {
                branchNameInput.value = branchNameInput.value.toUpperCase();
            });
        
            // Function to check if a branch already exists in the dropdown and list
            function branchExists(branchName) {
                var branchOptions = document.querySelectorAll('#branch option');
                for (var option of branchOptions) {
                    if (option.value.toUpperCase() === branchName.toUpperCase()) {
                        return true;
                    }
                }
                var branchItems = document.querySelectorAll('#branchList li');
                for (var item of branchItems) {
                    if (item.textContent.toUpperCase() === branchName.toUpperCase()) {
                        return true;
                    }
                }
                return false;
            }
        
            // Handle saving a new branch
            document.getElementById('saveBranch').addEventListener('click', function () {
                var branchName = document.getElementById('branchName').value;
        
                if (branchName) {
                    if (branchExists(branchName)) {
                        alert('This branch already exists.');
                        return; // Prevent further action
                    }
        
                    var xhr = new XMLHttpRequest();
                    xhr.open('POST', '/add_branch', true);
                    xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
                    xhr.onload = function () {
                        if (xhr.status === 200) {
                            var response = JSON.parse(xhr.responseText);
                            if (response.success) {
                                // Add the new branch to the dropdown
                                var branchSelect = document.getElementById('branch');
                                var newOption = document.createElement("option");
                                newOption.value = response.branch_name;
                                newOption.text = response.branch_name;
                                branchSelect.appendChild(newOption);
        
                                // Add the new branch to the filter list
                                var branchList = document.getElementById('branchList');
                                var newListItem = document.createElement("li");
                                newListItem.className = "list-group-item";
                                newListItem.textContent = response.branch_name;
                                newListItem.style.cursor = "pointer";
                                newListItem.style.padding = "10px";
                                newListItem.style.borderBottom = "1px solid #eee";
                                branchList.appendChild(newListItem);
        
                                // Clear the input and hide the modal
                                document.getElementById('branchName').value = ''; 
                                $('#branchModal').modal('hide'); // Hide the modal
                            }
                        } else {
                            console.error('Error adding branch:', xhr.responseText);
                        }
                    };
                    xhr.send('branchName=' + encodeURIComponent(branchName));
                } else {
                    alert('Please enter a branch name');
                }
            });
        
            // JavaScript to filter branch options based on input
            document.getElementById('branchFilter').addEventListener('input', function() {
                var filter = this.value.toLowerCase();
                var list = document.getElementById('branchList');
                var items = list.getElementsByTagName('li');
        
                for (var i = 0; i < items.length; i++) {
                    var item = items[i];
                    var option = item.textContent.toLowerCase();
        
                    if (option.startsWith(filter)) {
                        item.style.display = ''; // Show item
                    } else {
                        item.style.display = 'none'; // Hide item
                    }
                }
        
                // Show the list if there's input; otherwise, show all items
                if (filter === '') {
                    for (var i = 0; i < items.length; i++) {
                        items[i].style.display = ''; // Show all items
                    }
                }
            });
        
            // Handle click on a branch item
            document.getElementById('branchList').addEventListener('click', function(e) {
                if (e.target.tagName === 'LI') {
                    document.getElementById('branchFilter').value = e.target.textContent;
                    document.getElementById('branch').value = e.target.textContent; // Set the value of the hidden select field
                    this.style.display = 'none'; // Hide the list after selection
                }
            });
        
            // Close the dropdown if clicked outside
            document.addEventListener('click', function(e) {
                var list = document.getElementById('branchList');
                var filter = document.getElementById('branchFilter');
        
                if (!filter.contains(e.target) && !list.contains(e.target)) {
                    list.style.display = 'none';
                }
            });
        
            // Show the list when the input field is focused
            document.getElementById('branchFilter').addEventListener('focus', function() {
                document.getElementById('branchList').style.display = 'block';
            });
        </script>
    </body>
</html>
{% extends "uppercase.html" %}
{% include "alert.html" %}
